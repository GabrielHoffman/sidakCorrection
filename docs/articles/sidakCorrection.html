<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Numerically stable Sidak correction • sidakCorrection</title>
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Numerically stable Sidak correction">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sidakCorrection</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/sidakCorrection.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/GabrielHoffman/sidakCorrection/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Numerically stable Sidak correction</h1>
            <h3 data-toc-skip class="subtitle">Compare with other
implementations</h3>
                        <h4 data-toc-skip class="author">Developed by <a href="http://gabrielhoffman.github.io/" class="external-link">Gabriel Hoffman</a>
</h4>
            
            <h4 data-toc-skip class="date">Run on 2025-07-16
15:46:36</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/GabrielHoffman/sidakCorrection/blob/HEAD/vignettes/sidakCorrection.Rmd" class="external-link"><code>vignettes/sidakCorrection.Rmd</code></a></small>
      <div class="d-none name"><code>sidakCorrection.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="function-to-compute-using-multiple-methods">Function to compute using multiple methods<a class="anchor" aria-label="anchor" href="#function-to-compute-using-multiple-methods"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/GabrielHoffman/sidakCorrection" class="external-link">sidakCorrection</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">sidak</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">n</span>, <span class="va">method</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"adaptive"</span>, <span class="st">"double"</span>, <span class="st">"mpfr"</span>, <span class="st">"taylor"</span><span class="op">)</span>, <span class="va">precBits</span> <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>    <span class="va">method</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.arg.html" class="external-link">match.arg</a></span><span class="op">(</span><span class="va">method</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">method</span>, double <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">^</span><span class="va">n</span>, mpfr <span class="op">=</span> <span class="op">{</span></span>
<span>        <span class="va">p_mpfr</span> <span class="op">&lt;-</span> <span class="fu">Rmpfr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rmpfr/man/mpfr.html" class="external-link">mpfr</a></span><span class="op">(</span><span class="va">p</span>, precBits <span class="op">=</span> <span class="va">precBits</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_mpfr</span><span class="op">)</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span>, taylor <span class="op">=</span> <span class="op">{</span></span>
<span>        <span class="co"># Set the cutoff to be 1, so the Taylor series is always used</span></span>
<span>        <span class="fu"><a href="../reference/sidakCorrection.html">sidakCorrection</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">n</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">}</span>, adaptive <span class="op">=</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="../reference/sidakCorrection.html">sidakCorrection</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">n</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-for-single-p-values">Example for single p-values<a class="anchor" aria-label="anchor" href="#example-for-single-p-values"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fl">1e-18</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">1e+05</span></span>
<span></span>
<span><span class="fu">sidak</span><span class="op">(</span><span class="va">p</span>, <span class="va">n</span>, <span class="st">"double"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sidak</span><span class="op">(</span><span class="va">p</span>, <span class="va">n</span>, <span class="st">"mpfr"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1e-13</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sidak</span><span class="op">(</span><span class="va">p</span>, <span class="va">n</span>, <span class="st">"taylor"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1e-13</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sidak</span><span class="op">(</span><span class="va">p</span>, <span class="va">n</span>, <span class="st">"adaptive"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1e-13</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="compare-methods">Compare methods<a class="anchor" aria-label="anchor" href="#compare-methods"></a>
</h2>
<p>Here we plot the values from computing the Sidak correction using *
adaptive approach using either double precision or Taylor series
depending on the value of p * High precision with Rmpfr * standard
approach using double precision arithmetic * Taylor series</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, `Standard (double)` <span class="op">=</span> <span class="fu">sidak</span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, <span class="st">"double"</span><span class="op">)</span>, `High precision (mpfr)` <span class="op">=</span> <span class="fu">sidak</span><span class="op">(</span><span class="va">x</span>,</span>
<span>    <span class="va">n</span>, <span class="st">"mpfr"</span>, <span class="fl">1000</span><span class="op">)</span>, `Taylor series` <span class="op">=</span> <span class="fu">sidak</span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, <span class="st">"taylor"</span><span class="op">)</span>, Adaptive <span class="op">=</span> <span class="fu">sidak</span><span class="op">(</span><span class="va">x</span>,</span>
<span>    <span class="va">n</span>, <span class="st">"adaptive"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">value</span>, color <span class="op">=</span> <span class="va">name</span>, linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-19</span>,</span>
<span>    <span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Input p-value (log10 scale)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Sidak corrected p-value (log10 scale)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sidakCorrection_files/figure-html/approx-1.png" alt="Approximation accuracy" width="700"></p>
<p>We see that the double precision approach deviates from the high
precision method for small values of p, while the Taylor series deviates
for large values of p. The adpative approach used bo the
<code><a href="../reference/sidakCorrection.html">sidakCorrection()</a></code> function matches that high precision
method.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://gabrielhoffman.github.io" class="external-link">Gabriel Hoffman</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
